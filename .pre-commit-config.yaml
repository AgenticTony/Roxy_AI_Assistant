# Pre-commit hooks for Roxy AI Assistant
# Install: uv run pre-commit install
# Run manually: uv run pre-commit run --all-files

default_language_version:
  python: python3.12

repos:
  # Prevent committing secrets and sensitive files
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: detect-private-key
        name: Detect private keys
      - id: detect-aws-credentials
        name: Detect AWS credentials
      - id: detect-gitleaks
        name: Detect secrets with gitleaks
      - id: no-commit-to-branch
        name: Block commits to main/master
        args: [--branch, main, --branch, master]

  # Block .env and .env.* files from being committed
  - repo: local
    hooks:
      - id: block-env-files
        name: Block .env file commits
        entry: |
          Block .env files from being committed. Use macOS Keychain for secrets instead.
        language: fail
        files: '\.env(\..+)?$'
        pass_filenames: false

  # Python linting and formatting
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.9
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format

  # Security scanning with bandit
  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.8
    hooks:
      - id: bandit
        args: [-r, src/roxy/, -ll]
        additional_dependencies: ["bandit[toml]"]
